{% extends "base.html" %}
{% block content %}
  <div class="detail-container">
    <div class="title-heart-container">
      <h1>{{ movie.title }}</h1>
       <div class="actions">
          <a href="{% url 'movies:movie_update' pk=movie.id %}" class="edit-link">
            <i class="fas fa-pencil-alt"></i>
          </a>
          <a href="{% url 'movies:toggle-add-to-favourites' pk=movie.id %}" class="favourite-toggle">
            {% if is_favourite %}
              <i class="fas fa-heart"></i>
            {% else %}
              <i class="far fa-heart"></i>
            {% endif %}
          </a>
        </div>
    </div>
    <div class="detail-film-info-container">
      <div class="detail-film-photo-container">
        <img src="{{ movie.poster.url }}" alt="Movie Poster Picture" class="detail-photo">
      </div>
      <div class="detail-film-info">
        <p>Rating: {{ movie.average_rating }}</p>
        <div class="movie-info-links">
          <p>Directors: </p>
          {% for director in movie.director.all %}
            <a href="{% url 'movies:director_detail' pk=director.id %}" class="movie-info-link">
              {{ director.first_name }} {{ director.last_name }}
            </a>
            {% if not forloop.last %}, {% endif %}
          {% empty %}
            <p>This movie has no directors</p>
          {% endfor %}
        </div>
        <div class="movie-info-links">
          <p>Actors: </p>
          {% for actor in movie.actors.all %}
            <a href="{% url 'movies:actor_detail' pk=actor.id %}" class="movie-info-link">
              {{ actor.first_name }} {{ actor.last_name }}
            </a>
            {% if not forloop.last %}, {% endif %}
          {% empty %}
            <p>This movie has no actors</p>
          {% endfor %}
        </div>
        <div class="movie-info-links">
          <p>Genres: </p>
          {% for genre in movie.genres.all %}
            <p class="movie-info-link">
              {{ genre.name }}
            </p>
          {% if not forloop.last %}, {% endif %}
          {% empty %}
            <p>This movie has no genres</p>
          {% endfor %}
        </div>
      </div>
    </div>
    <h2>What "{{ movie.title }}" is about:</h2>
    <p>{{ movie.description }}</p>
    <br>
{# TODO rating with stars #}
    <div class="centered-heading">
      <h1>Reviews</h1>
      <h1>
        <a href="{% url 'movies:add_review' pk=movie.id %}">Add review</a>
      </h1>
    </div>
    <ul class="item-list">
      {% for review in movie.reviews.all %}
        {# TODO user profiles with all reviews and link to them#}
          <li class="item" onclick="window.location.href='/';">
            <h4>
              <a href="{% url 'movies:user_detail' pk=review.creator.id %}">
                {{ review.creator.first_name }} {{ review.creator.last_name }}
                <div class="profile-pic-container">
                  <img src="{{ review.creator.profile_pic.url }}" alt="User Profile Picture" class="profile-pic">
                </div>
              </a>
            </h4>
            <p>{{ review.rating }}</p>
            <p>{{ review.comment }}</p>
            <p>{{ review.created_at }}</p>
          </li>
      {% empty %}
        <p>There are no reviews</p>
      {% endfor %}
    </ul>
  </div>
{% endblock %}
